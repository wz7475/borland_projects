//---------------------------------------------------------------------------

#include <vcl.h>
#include <fstream>
#include <iostream>
#include <cstdlib>
using namespace std;
#pragma hdrstop

#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "trayicon"
#pragma resource "*.dfm"
TForm1 *Form1;
int s=0, czas=0;

//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------


void __fastcall TForm1::Timer1Timer(TObject *Sender)
{
        s++;
        int godzin, minut, sekund;
        AnsiString godz, min, sek;

        godzin=s/3600;
        godz=IntToStr(godzin);
        if(godzin<10) godz="0"+godz;

        minut=(s-godzin*3600)/60;
        min=IntToStr(minut);
        if(minut<10) min="0"+min;

        sekund=s-godzin*3600-minut*60;
        sek=IntToStr(sekund);
        if(sekund<10) sek="0"+sek;

        Label1->Caption=godz+":"+min+":"+sek;

}
//---------------------------------------------------------------------------

void __fastcall TForm1::TrayIcon1Click(TObject *Sender)
{
        Show();
        Application->BringToFront();        
}
//---------------------------------------------------------------------------




void __fastcall TForm1::FormCreate(TObject *Sender)
{
        fstream plik;
        int czas=0;
        
        //AnsiString sciezka_do_pliku = ExtractFilePath(Application->ExeName) + "czas2.txt";
        //const char* sciezka=sciezka_do_pliku.c_str();
        plik.open("C:\Users\wojte\Desktop\text\time.txt", ios::in);
        //if(plik.good()==false)Application->MessageBox(
        //"Remember to keep this appliction file (.exe) in the same directory with text directory containig text file (time.txt).",
        //"Problem with text file", MB_OK | MB_ICONWARNING);
        string linia;
        while(getline(plik, linia))
        {
               czas+=atoi(linia.c_str());
        }
        plik.close();
        int godzin, minut;
        AnsiString godz, min;
        godzin=czas/60;
        godz=IntToStr(godzin);
        if(godzin<10) godz="0"+godz;
        minut=czas-godzin*60;
        min=IntToStr(minut);
        if(minut<10) min="0"+min;
        Label2->Caption=godz+":"+min;
}
//---------------------------------------------------------------------------




void __fastcall TForm1::Timer2Timer(TObject *Sender)
{
       fstream plik;
       //AnsiString sciezka_do_pliku = ExtractFilePath(Application->ExeName) + "czas2.txt";
       //const char* sciezka=sciezka_do_pliku.c_str();
       plik.open("C:\Users\wojte\Desktop\text\time.txt", ios::out | ios::app);
       plik<<1<<endl;
       plik.close();
}
//---------------------------------------------------------------------------



